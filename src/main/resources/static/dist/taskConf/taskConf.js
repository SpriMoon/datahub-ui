var vm=new Vue({el:".detailCon",data:{sourceInfo:{},targetInfo:{},maskShow:!1,globalParam:{urlObj:{}},jobInfo:{},otherParams:{},keyLang:{groupNo:common_js_lang["manage.title.srcType"],ip:common_js_lang["clientList.option.ip"],port:common_js_lang["dbManage.option.port"],host:common_js_lang["dbManage.option.addr"],userName:common_js_lang["dbManage.option.userName"],accessKey:common_js_lang["s3.option.keyId"],region:common_js_lang["s3.option.region"],libType:common_js_lang["db.option.resourceType"],connName:common_js_lang["dbManage.option.connName"],dbType:common_js_lang["dbManage.option.dbType"],dbName:common_js_lang["dbManage.option.dbName"],url:common_js_lang["dbManage.option.link"]+" URL",hdfs:common_js_lang["dbManage.title.setHdfsLink"],hive:common_js_lang["dbManage.title.hiveUser"],tarType:common_js_lang["local.title.tarDir"],authType:common_js_lang["dbManage.title.authType"],coreSite:"core-site.xml "+common_js_lang["dbManage.option.path"],hdfsSite:"hdfs-site.xml "+common_js_lang["dbManage.option.path"],srcType:common_js_lang["conf.text.srcType"],sourcePath:common_js_lang["conf.option.srcPath"],sourceFile:common_js_lang["conf.option.srcFileName"],tarFile:common_js_lang["conf.option.tarFileName"],tarPath:common_js_lang["conf.option.tarPath"],size:common_js_lang["conf.option.size"],sourceDbName:common_js_lang["dump.option.sourceDb"],sourceTblName:common_js_lang["dump.option.sourceTbl"],tarDbName:common_js_lang["db.option.tarDb"],tarTblName:common_js_lang["dump.option.tarTbl"],tarPart:common_js_lang["dump.option.tarPart"],ddl:common_js_lang["local.option.tarSql"],whereSql:common_js_lang["conf.option.whereSql"],replacement:common_js_lang["db.option.replaceMent"],tip:common_js_lang["clientList.note.mark"],columnSep:common_js_lang["conf.option.columnSep"],fieldEnClosed:common_js_lang["conf.option.fieldEnClosed"],krb5Conf:"krb5.conf "+common_js_lang["dbManage.option.path"],keytab:"Keytab "+common_js_lang["dbManage.option.path"],principal:common_js_lang["conf.option.kerberos"],pattern:common_js_lang["conf.option.pattern"],srcFileHandleType:common_js_lang["conf.option.srcSet"],tarRenameType:common_js_lang["conf.option.nuptial"],sourceView:common_js_lang["conf.option.srcView"],protocol:common_js_lang["conf.option.protocol"],fromIsPart:common_js_lang["conf.option.isPart"],toIsPart:common_js_lang["conf.option.isPart"],hivePartConf:common_js_lang["conf.option.partSet"],sqlQuery:common_js_lang["db.option.sqlQuery"]},detailTitle:[],detailInfo:[],detailHeadClass:"",dbtype:{38:"MySQL",52:"AliMySQL",56:"AwsMySQL",4:"Oracle",60:"AwsOracle",40:"SQL Server",53:"AliSQLServer",57:"AwsSQLServer",44:"DB2",24:"PostgreSQL",54:"AliPostgreSQL",58:"AwsPostgreSQL"},ddlShow:[!1],whereSqlShow:[!1],codeMirrorItems:[],partShow:[!1],gotPart:[!1],expPartDefer:[],ddlAjaxHandle:[!1],y:[0],toType:{8:"HDFS",9:"HIVE",13:"Spark MPP",2:"Database",6:"Aliyun RDS",7:"Amazon RDS"}},created:function(){for(var e=location.search.replace(/^\?|\?$/g,"").split("&"),t=0,o=e.length;t<o;t++){var a=e[t].split("=");this.globalParam.urlObj[a[0]]=a[1]||""}var n=this;n.maskShow=!0,$.ajax({url:"job/detail?jobId="+this.globalParam.urlObj.id,success:function(e){if(200==e.code)try{console.log(e.model);var t={};(t=$.extend({},e.model)).pid=common_project[t.pid].name,t.cronExpression=n.regularState(t),t.createTime=n.dateFormat(t.createTime,"yyyy/MM/dd hh:mm:ss"),n.jobInfo=t;var o="",a={},i=!1;if([1,4,10,11].indexOf(+t.groupNo)>-1?a.groupNo=common_js_lang[t.groupName]:12==t.groupNo?(a.groupNo=common_js_lang["job.group.ftp"],t.fromObject?(a.libType=-1==t.fromObject.delFlg?common_js_lang["conf.text.tmpConn"]:common_js_lang["conf.text.savedConn"],a.ip=t.fromObject.host,a.port=t.fromObject.port,a.protocol=["FTP - "+common_js_lang["conf.text.ftp"],"SFTP- SSH"+common_js_lang["conf.text.ftp"]][+t.fromObject.protocol-1],a.userName=t.fromObject.userName,a.connName=t.fromObject.connName):o+=common_js_lang["conf.info.srcNull"]):5==t.groupNo?(a.groupNo=common_js_lang["job.group.s3"],a.accessKey=t.fromObject.accessKey,a.region=t.fromObject.regionStr):[2,6,7].indexOf(+t.groupNo)>-1?t.fromObject?(a.groupNo=n.dbtype[t.fromObject.dbType],a.libType=-1==t.fromObject.delFlg?common_js_lang["conf.text.tmpConn"]:common_js_lang["conf.text.savedConn"],a.connName=t.fromObject.connName,a.dbType=n.dbtype[t.fromObject.dbType],a.host=t.fromObject.host,a.port=t.fromObject.port,a.dbName=t.fromObject.dbName,a.userName=t.fromObject.userName,a.url=t.fromObject.url):o+=common_js_lang["conf.info.srcNull"]:t.fromObject?(a.groupNo=common_js_lang["job.group.hive"],a.connName=t.fromObject.connName,a.hdfs=t.fromObject.hid,a.host=t.fromObject.host,a.hive=t.fromObject.userName,a.url=t.fromObject.url,a.hdfs==adminConfigData.hdfs.id?a.hdfs=adminConfigData.hdfs.connName:(i=!0,$.ajax({url:"hdfs/list?pid="+e.model.pid,success:function(e){if(200!=e.code)return ErrTip(e.i18nMsg.title,e.i18nMsg.detail,e.msg),void(n.sourceInfo=a);for(var t=e.model.data,o=0,i=t.length;o<i;o++)if(t[o].id==a.hdfs){a.hdfs=t[o].connName;break}n.sourceInfo=a}}))):o+=common_js_lang["conf.info.srcNull"],i||(n.sourceInfo=a),t.toObject){var r={};r.tarType=n.toType[+t.toType],r.connName=t.toObject.connName,r.authType=t.toObject.authType&&["simple","kerberos","sentry"][+t.toObject.authType-1],r.coreSite=t.toObject.coreSiteXml,r.hdfsSite=t.toObject.hdfsSiteXml,r.krb5Conf=t.toObject.krb5Conf,r.keytab=t.toObject.keytab,r.principal=t.toObject.principal,r.userName=[9,13].indexOf(+t.toType)>-1?"":t.toObject.userName,r.hdfs=t.toObject.hid,r.host=t.toObject.host,r.dbName=[9,13].indexOf(+t.toType)>-1?"":t.toObject.dbName,r.hive=[9,13].indexOf(+t.toType)>-1?t.toObject.userName:"",r.url=t.toObject.url,3==t.toObject.authType&&common_project[e.model.pid].proxyUser&&(r.userName=common_project[e.model.pid].proxyUser),t.toObject.authType||e.model.toObject.id==adminConfigData.hive.id&&(r.hive=common_project[e.model.pid].proxyUser),r.hdfs?r.hdfs==adminConfigData.hdfs.id?(r.hdfs=adminConfigData.hdfs.connName,n.targetInfo=r):$.ajax({url:"hdfs/list?pid="+e.model.pid,success:function(e){if(200!=e.code)return ErrTip(e.i18nMsg.title,e.i18nMsg.detail,e.msg),void(n.targetInfo=r);for(var t=e.model.data,o=0,a=t.length;o<a;o++)if(t[o].id==r.hdfs){r.hdfs=t[o].connName;break}n.targetInfo=r}}):n.targetInfo=r}else o+=(o?"\n":"")+common_js_lang["conf.info.tarNull"];o&&MsgTip("",o,"");var s=[],l=[];if([5,12].indexOf(+t.groupNo)>-1)t.fromList[0].usePattern?(l=["sourcePath","pattern","srcFileHandleType","tarPath","tarFile","tarRenameType"],t.fromList.map(function(e,o){s[o]={sourcePath:e.filePath,pattern:e.pathPattern,srcFileHandleType:[common_js_lang["conf.option.notChangeFile"],common_js_lang["conf.option.delFile"],common_js_lang["conf.option.moveFile"]][1==+e.srcFileHandleType?0:+e.srcFileHandleType-2]+(4==+e.srcFileHandleType?e.srcFileMoveDir:""),tarPath:t.toList[o].fileName,tarFile:[common_js_lang["conf.option.srcFile"],common_js_lang["conf.option.srcFileAdd"]][3==+e.tarRenameType?1:0]+(3==+e.tarRenameType?"_yyyyMMdd"===e.tarRenameFormat?common_js_lang["conf.option.importDate"]:common_js_lang["conf.option.importTime"]:""),tarRenameType:[common_js_lang["conf.option.override"],common_js_lang["conf.option.append"],common_js_lang["conf.option.ignore"],common_js_lang["conf.option.addNumber"]][+t.toList[o].tarFileHandleType-1]}})):(l=["sourcePath","sourceFile","tarPath","tarFile","size"],12==t.groupNo&&l.unshift("srcType"),t.fromList.map(function(e,o){s[o]={srcType:e.directory?common_js_lang["conf.text.dirType"]:common_js_lang["conf.text.fileType"],sourcePath:e.directory?e.filePath:e.bucketName||e.filePath.replace(/\\/g,"/").split("/").slice(0,-1).join("/"),sourceFile:e.directory?"":e.key||e.filePath.replace(/\\/g,"/").split("/").slice(-1).join("/"),tarPath:e.directory?t.toList[o].fileName:t.toList[o].fileName.split("/").slice(0,-1).join("/"),tarFile:e.directory?"":t.toList[o].fileName.split("/").slice(-1).join("/"),size:e.directory?"":n.convertFileSize(e.size)}}));else if([2,6,7].indexOf(+t.groupNo)>-1){var c=["","sourceTblName","sourceView"][+(p=JSON.parse(t.otherParams).srcType)];3==p?8!=t.toType?(l=["sqlQuery","tarDbName","tarTblName","tarPart","ddl"],t.fromList.map(function(e,o){s[o]={sqlQuery:e.sql,tarDbName:t.toList[o].name,tarTblName:t.toList[o].tableName,tarPart:(t.toList[o].partition||"").replace(/,/g,"<br>"),ddl:"<a>"+common_js_lang["conf.act.viewSql"]+"</a>",schema:t.toList[o].schema,catalog:t.toList[o].catalog,dbId:t.toList[o].dbId}})):(l=["sqlQuery","tarPath","tarFile"],t.fromList.map(function(e,o){s[o]={sqlQuery:e.sql,tarFile:t.toList[o].fileName.split("/").slice(-1).join("/"),tarPath:t.toList[o].fileName.split("/").slice(0,-1).join("/")}})):8!=t.toType?(l=["sourceDbName",c,"tarDbName","tarTblName","tarPart","ddl","whereSql","replacement"],t.fromList.map(function(e,o){try{var a=JSON.parse(e.synchColumnMap),i=a.srcSynchColumn?a.srcSynchColumn.alias+" --\x3e "+a.tagSynchColumn.alias:""}catch(e){i=""}s[o]={sourceDbName:e.name,tarDbName:t.toList[o].name,tarTblName:t.toList[o].tableName,tarPart:(t.toList[o].partition||"").replace(/,/g,"<br>"),ddl:"<a>"+common_js_lang["conf.act.viewSql"]+"</a>",whereSql:e.whereSql||i,replacement:t.toList[o].replaceEnter?"<b>'</b>"+t.toList[o].replacement+"<b>'</b>"+n.str2tip(t.toList[o].replacement):common_js_lang["conf.type.disable"],replacementStr:t.toList[o].replaceEnter?"'"+t.toList[o].replacement+"'":common_js_lang["conf.type.disable"],dbId:t.toList[o].dbId,schema:t.toList[o].schema,catalog:t.toList[o].catalog},s[o][c]=e.tableName})):(l=["sourceDbName",c,"tarPath","tarFile","whereSql","replacement"],t.fromList.map(function(e,o){s[o]={sourceDbName:e.name,tarFile:t.toList[o].fileName.split("/").slice(-1).join("/"),tarPath:t.toList[o].fileName.split("/").slice(0,-1).join("/"),whereSql:e.whereSql,replacement:t.toList[o].replaceEnter?"<b>'</b>"+t.toList[o].replacement+"<b>'</b>"+n.str2tip(t.toList[o].replacement):common_js_lang["conf.type.disable"],replacementStr:t.toList[o].replaceEnter?"'"+t.toList[o].replacement+"'":common_js_lang["conf.type.disable"]},s[o][c]=e.tableName}))}else if(1==t.groupNo)l=["sourceFile","tarPath","tarFile","size"],t.fromList.map(function(e,o){s[o]={sourceFile:e.filePath.replace(/\\/g,"/").split("/").slice(-1).join("/"),tarFile:t.toList[o].fileName.split("/").slice(-1).join("/"),tarPath:t.toList[o].fileName.split("/").slice(0,-1).join("/"),size:e.size&&n.convertFileSize(e.size)}});else if([10,11].indexOf(+t.groupNo)>-1)if(8==t.toType)l=["sourceFile","tarFile","tarPath"],t.fromList.map(function(e,o){s[o]={sourceFile:e.srcPath.replace(/\\/g,"/").split("/").slice(-1).join("/"),tarFile:t.toList[o].fileName.split("/").slice(-1).join("/"),tarPath:t.toList[o].fileName.split("/").slice(0,-1).join("/"),size:e.size&&n.convertFileSize(e.size)}});else if(10==t.groupNo)l=["sourceFile","tarDbName","tarTblName","tarPart","ddl","columnSep","fieldEnClosed","tip"],t.fromList.map(function(e,o){s[o]={sourceFile:e.srcPath.replace(/\\/g,"/").split("/").slice(-1).join("/"),tarDbName:t.toList[o].name,tarTblName:t.toList[o].tableName,tarPart:(t.toList[o].partition||"").replace(/,/g,"<br>"),ddl:"<a>"+common_js_lang["conf.act.viewSql"]+"</a>",columnSep:"<b>'</b>"+e.columnSep+"<b>'</b>"+n.str2tip(e.columnSep),columnSepStr:"'"+e.columnSep+"'",fieldEnClosed:e.fieldEnClosed||"",tip:common_js_lang["conf.text.dataLineNo"].replace(/\[x\]/,"["+e.dataLineNo+"]"),dbId:t.toList[o].dbId,schema:t.toList[o].schema,catalog:t.toList[o].catalog}});else{l=["sourceFile","sourceTblName","tarDbName","tarTblName","tarPart","ddl","tip"];var m=0;t.fromList.map(function(e,o){e.sheets.map(function(a,n){s[m]={sourceFile:e.srcPath.replace(/\\/g,"/").split("/").slice(-1).join("/"),sourceTblName:a.name,tarDbName:t.toList[o][a.index].name,tarTblName:t.toList[o][a.index].tableName,tarPart:(t.toList[o][a.index].partition||"").replace(/,/g,"<br>"),ddl:"<a>"+common_js_lang["conf.act.viewSql"]+"</a>",tip:common_js_lang["conf.text.dataLineNo"].replace(/\[x\]/,"["+(+a.dataRowIndex+1)+"]"),dbId:t.toList[o][a.index].dbId,schema:t.toList[o][a.index].schema,catalog:t.toList[o][a.index].catalog},m++})})}else if(4==t.groupNo)8==t.toType?(l=["sourceFile","sourceTblName","tarPath","tarFile","size"],t.fromList.map(function(e,o){s[o]={sourceFile:e.srcPath.replace(/\\/g,"/").split("/").slice(-1).join("/"),sourceTblName:e.tableName,tarPath:t.toList[o].fileName.split("/").slice(0,-1).join("/"),tarFile:t.toList[o].fileName.split("/").slice(-1).join("/"),size:n.convertFileSize(e.size)}})):(l=["sourceFile","sourceTblName","tarDbName","tarTblName","tarPart","ddl"],t.fromList.map(function(e,o){s[o]={sourceFile:e.srcPath.replace(/\\/g,"/").split("/").slice(-1).join("/"),sourceTblName:e.tableName,tarDbName:t.toList[o].name,tarTblName:t.toList[o].tableName,tarPart:(t.toList[o].partition||"").replace(/,/g,"<br>"),ddl:"<a>"+common_js_lang["conf.act.viewSql"]+"</a>",dbId:t.toList[o].dbId,schema:t.toList[o].schema,catalog:t.toList[o].catalog}}));else{var p=JSON.parse(t.otherParams).srcType;l=["sourceDbName",c=["","sourceTblName","sourceView"][+p],"fromIsPart","tarDbName","tarTblName","ddl","toIsPart","hivePartConf"],n.detailInfo=$.extend({},s),t.fromList.map(function(e,o){if(s[o]={sourceDbName:e.name,fromIsPart:e.partitionTable?common_js_lang["db.text.yes"]:common_js_lang["conf.text.no"],toIsPart:t.toList[o].partitionTable?common_js_lang["db.text.yes"]:common_js_lang["conf.text.no"],isViewPart:t.toList[o].partitionTable?1:0,tarDbName:t.toList[o].name,tarTblName:t.toList[o].tableName,ddl:"<a>"+common_js_lang["conf.act.viewSql"]+"</a>",hivePartConf:t.toList[o].partition||"",dbId:t.toList[o].dbId,schema:t.toList[o].schema,catalog:t.toList[o].catalog,useSynchronized:e.useSynchronized,tarPartHandleType:e.tarPartHandleType},s[o][c]=e.tableName,t.toList[o].partition){var a=JSON.parse(t.toList[o].partition),n=[];if(e.partitionTable){var i=JSON.parse(e.partition),r=a[0].split(","),l=i[0].split(","),m=[],p=[];r.map(function(e,t){m.push(e.split("=")[0])}),l.map(function(e,t){p.push(e.split("=")[0])}),s[o].hivePartConf={tarColumn:m,fromPart:i,tarPart:a}}else a[0].split(",").map(function(e,t){var o=e.split("="),a=o[0],i=o.slice(1).join("=");n.push({key:a,val:i})}),s[o].hivePartConf={tarPart:n}}})}n.detailTitle=l,n.detailInfo=s,n.detailHeadClass=s.length>10?"scroll":"",Vue.nextTick(function(){$(".infoCon [rel=tipsy]").tipsy({fade:!0,gravity:"n",html:!0});var e=$(".detailCon #detail .infoCon .showDdl .srcSql textarea");e.length>0&&CodeMirror.fromTextArea(e[0],{lineNumbers:!0})})}catch(e){ErrTip("",e,"")}else ErrTip(e.i18nMsg.title,e.i18nMsg.detail,e.msg)},complete:function(){n.maskShow=!1}})},computed:{},methods:{srcSql:function(e){console.log("refresh"),$(this.$refs.area).find(".CodeMirror")[0].CodeMirror.refresh()},getExpPart:function(e,t){this.gotPart[t]=!0,this.maskShow=!0;var o=JSON.parse(e.toList[t].partitionExpDefault),a=[],n=[],i=$.Deferred(),r=$.Deferred();$.ajax({url:"db/table/partitions",type:"post",data:{dbId:e.fromId,catalog:e.fromList[t].catalog,schema:e.fromList[t].schema,tableName:e.fromList[t].tableName},success:function(e){200==e.code?n=e.model.map(function(e,t){return e.name}):ErrTip(e.i18nMsg.title,e.i18nMsg.detail,e.msg)},complete:function(){r.resolve()}}),$.ajax({url:"db/table/partitions",type:"post",data:{dbId:e.toId,catalog:e.fromList[t].catalog,schema:e.toList[t].schema,tableName:e.toList[t].tableName},success:function(e){200==e.code?a=e.model.map(function(e,t){return e.name}):ErrTip(e.i18nMsg.title,e.i18nMsg.detail,e.msg)},complete:function(){i.resolve()}});var s=this;$.when(r,i).then(function(){s.detailInfo[t].hivePartConf={tarColumn:a,srcColumn:n,expPart:o},Vue.set(s.detailInfo,t,s.detailInfo[t])}).always(function(){s.maskShow=!1,Vue.set(s.partShow,t,!0)})},str2tip:function(e){return""===e?"("+common_js_lang["db.info.emptyString"]+")":e.match(/^\s+$/)?"("+(e.match(/\s/g).length+common_js_lang["db.text.space"])+")":""},time2str:function(e){if(!e)return"";var t=new Date(e),o=t.getFullYear(),a=t.getMonth()+1,n=t.getDate();return a<10&&(a="0"+a),n<10&&(n="0"+n),o+"-"+a+"-"+n},regularState:function(e){var t=e.cronExpression,o={startTimeStr:this.time2str(e.startTime),endTimeStr:this.time2str(e.endTime)},a="";if(0==e.periodType)return common_js_lang["job.period.PeriodOnceImmed"];if(1==e.periodType){var n=(r=t.split(" "))[6]+"-"+(+r[4]>=10?r[4]:"0"+r[4])+"-"+(+r[3]>=10?r[3]:"0"+r[3]),i=(+r[2]>=10?r[2]:"0"+r[2])+":"+(+r[1]>=10?r[1]:"0"+r[1])+":"+(+r[0]>=10?r[0]:"0"+r[0]);return common_js_lang["cron.text.exec1"]+" ["+n+" "+i+"]"}if("* * ?"==t.slice(-5)){a+=common_js_lang["cron.text.hourTy"]+",";r=t.split(" ");a+=common_js_lang["cron.text.timeIs"]+" ["+(+r[1]>=10?r[1]:"0"+r[1])+":"+(+r[0]>=10?r[0]:"0"+r[0])+"]"}else if("* ?"==t.slice(-3)){var r=t.split(" ");a+=common_js_lang["cron.text.dayTy"]+","+common_js_lang["cron.text.timeIs"]+" ["+(+r[2]>=10?r[2]:"0"+r[2])+":"+(+r[1]>=10?r[1]:"0"+r[1])+":"+(+r[0]>=10?r[0]:"0"+r[0])+"]"}else if("?"==t.slice(-1)){var s=(r=t.split(" "))[3];a+=common_js_lang["cron.text.monthTy"]+","+common_js_lang["cron.text.timeIs"]+("L"==s?"["+common_js_lang["client.text.lastDay"]+"]":common_js_lang["cron.text.dayNum"].replace(/\[x\]/,"["+s+"]"))+" ["+(+r[2]>=10?r[2]:"0"+r[2])+":"+(+r[1]>=10?r[1]:"0"+r[1])+":"+(+r[0]>=10?r[0]:"0"+r[0])+"]"}else{var l=(r=t.split(" "))[5].split(",");a+=common_js_lang["cron.text.weekTy"]+","+common_js_lang["cron.text.timeIs"]+" [ ",l.map(function(e){a+=[common_js_lang["client.text.sun"],common_js_lang["client.text.Mon"],common_js_lang["client.text.Tue"],common_js_lang["client.text.wed"],common_js_lang["client.text.thu"],common_js_lang["client.text.fri"],common_js_lang["client.text.sat"]][+e-1]+" "}),a+="] ["+(+r[2]>=10?r[2]:"0"+r[2])+":"+(+r[1]>=10?r[1]:"0"+r[1])+":"+(+r[0]>=10?r[0]:"0"+r[0])+"] "}return a+=o.endTimeStr?" "+common_js_lang["cron.text.valid"]+" "+o.startTimeStr+" "+common_js_lang["client.text.to"]+" "+o.endTimeStr:" ."+common_js_lang["cron.text.from"]+" "+o.startTimeStr+" "+common_js_lang["cron.text.startEff"]+"."},dateFormat:function(e,t){var o={M:(e=new Date(e)).getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),q:Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};return t=t.replace(/([yMdhmsqS])+/g,function(t,a){var n=o[a];return void 0!==n?(t.length>1&&(n=(n="0"+n).substr(n.length-2)),n):"y"===a?(e.getFullYear()+"").substr(4-t.length):t})},parsePart:function(e){if(e){var t={};e.split(",").map(function(e){var o=e.split("=");t[o[0]]=o[1].replace(/^\'|\'$/g,"")})}},convertFileSize:function(e){return(e=e||0)<1024?(e||0)+" bytes":e/1024<1024?(e/1024).toFixed(2)+" KB":(e/1024/1024).toFixed(2)+" MB"},getDdl:function(e,t,o){this.y[t]=o.pageY;var a=!this.ddlShow[t];this.ddlShow=[!1],Vue.set(this.ddlShow,t,a);var n=this;n.detailInfo[t].sql?setTimeout(function(){n.codeMirrorItems[t].refresh()},0):n.ddlAjaxHandle[t]||(n.ddlAjaxHandle[t]=!0,$.ajax({url:"db/table/ddl/show",data:e,success:function(e){200!=e.code?n.detailInfo[t].sql=e.msg:n.detailInfo[t].sql=e.model.ddl,Vue.set(n.detailInfo,t,n.detailInfo[t]),setTimeout(function(){n.codeMirrorItems[t]=CodeMirror.fromTextArea($(".detailCon #detail .infoCon .flex-item").eq(t).find(".showDdl .content textarea")[0],{lineNumbers:!0})},0)}}))},ddlOut:function(e){Vue.set(this.ddlShow,e,!1)},ddlOver:function(e){Vue.set(this.ddlShow,e,!0)},whereSqlOut:function(e){Vue.set(this.whereSqlShow,e,!1)},whereSqlOver:function(e){Vue.set(this.whereSqlShow,e,!0)},partOut:function(e){Vue.set(this.partShow,e,!1)},partOver:function(e){Vue.set(this.partShow,e,!0),!this.gotPart[e]&&this.jobInfo.fromList[e].useSynchronized&&this.getExpPart(this.jobInfo,e)}}});