$(function(){function e(){function e(e){return e<1024?(e||0)+"bytes":e<1048576?(e/1024).toFixed(2)+"KB":(e/1024/1024).toFixed(2)+"MB"}function t(e){var t=new Date(e);return t=t.toLocaleDateString().replace(/\//g,"-")+" "+t.toTimeString().substr(0,8)}function s(e,t){$.ajax({url:"job/dump/file/detail",data:{id:e,lines:t},success:function(e){if(-1==e.code)return location.href="./",!1;if(200==e.code)for(var t="",s=e.model.split("\n"),i=0;i<s.length;i++)t+='<p><span class="time">'+s[i]+"</span><span></span></p>";else 0==e.code&&(t='<p style="color:#f00;">'+e.msg+"</p>");$(".someRecord").html(t)}})}!function(i){$.ajax({url:"job/dump/version",data:{id:i},success:function(i){if(-1==i.code)return location.href="./",!1;if(200==i.code){var a="<tr><td>"+i.model.version+"</td><td>"+t(i.model.createTime)+"</td>";if(8==i.model.toType)d="<td>HDFS</td>";else if(9==i.model.toType)d="<td>HIVE</td>";else if(2==i.model.toType)var d="<td>database</td>";var l="<td>"+i.model.dumpList.length+"</td><td>"+e(i.model.totalSize)+"</td></tr>"}$("#versionTb").append(a+d+l);for(var o="",n=0;n<i.model.dumpList.length;n++)o+='<div class="oneMsg" bakPath="'+i.model.dumpList[n].bakPath.replace(/\\/g,"/")+'" desPath="'+i.model.dumpList[n].destPath+'" tableName="'+i.model.dumpList[n].tableName+'" field="'+i.model.dumpList[n].id+'"><span class="index">'+(n+1)+'</span><p class="fileMsg"><span class="tabName" title="'+i.model.dumpList[n].tableName+"  "+e(i.model.dumpList[n].size)+'">'+i.model.dumpList[n].tableName+'</span><span class="size">'+e(i.model.dumpList[n].size)+"</span></p></div>";$(".versionDb").html(o);try{var r=i.model.dumpList[0].id;$("#aDumpTask").html(i.model.dumpList[0].tableName),$(".siteImport").html(i.model.dumpList[0].destPath),$(".bakSite").html(i.model.dumpList[0].bakPath.replace(/\\/g,"/")),$(".oneMsg").eq(0).addClass("clickStyle"),s(r,100)}catch(e){}}})}(function(){var e=location.search,t=new Object;if(-1!=e.indexOf("?")){var s=e.substr(1);strs=s.split("&");for(var i=0;i<strs.length;i++)t[strs[i].split("=")[0]]=unescape(strs[i].split("=")[1])}return t}().id),$("body").on("mouseover",".oneMsg",function(){$(this).addClass("oneMsgHover").siblings().removeClass("oneMsgHover"),$(this).children(".index").addClass("indexHover"),$(this).siblings().children(".index").removeClass("indexHover"),$(this).children(".fileMsg").children(".tabName").addClass("hoverTab"),$(this).siblings().children(".fileMsg").children(".tabName").removeClass("hoverTab")}),$("body").on("click",".oneMsg",function(){$(this).addClass("clickStyle").siblings().removeClass("clickStyle"),$("#aDumpTask").html($(this).attr("tableName")),$(".siteImport").html($(this).attr("desPath")),$(".bakSite").html($(this).attr("bakPath"))}),$("body").on("click",".oneMsg",function(){s($(this).attr("field"),100)}),$(".oneMsg").eq(0).addClass("clickStyle")}e()});