function fileSize(e){return e<1024?(e||0)+"bytes":e<1048576?(e/1024).toFixed(2)+"KB":(e/1024/1024).toFixed(2)+"MB"}function getDate(e){var t=new Date(e);return t=t.toLocaleDateString().replace(/\//g,"-")+" "+t.toTimeString().substr(0,8)}function getRecent3month(){if(curMonth<3)e=curYear-1+"-"+(curMonth-2+12);else var e=curYear+"-"+(curMonth-2);return e}function versionInit(e){var t=+e.pageNo||1;t<1&&(t=1),e.pageNo=t,$.ajax({url:"job/dump/version/list",data:{pageNo:e.pageNo,pageSize:e.pageSize,version:e.likeVer,startTimeStr:e.startTimeStr,endTimeStr:e.endTimeStr},success:function(a){if(a.model.totalPage&&a.model.totalPage<t)return e.pageNo=a.model.totalPage,void versionInit(e);$(".versionTabZone").html(template("template/dumpVersionTotal",{data:a.model.data})),$(".versionTabZone .pager").bootpag({total:a.model.totalPage,page:a.model.currentPage,maxVisible:5,leaps:!1,firstLastUse:!0,prev:"<i>〈</i>",next:"<i>〉</i>",first:"<i>《</i>",last:"<i>》</i>"}).off().on("page",function(t,a){e.pageNo=a,e.likeVer=$(".searchInput").val(),e.startTimeStr=$("#startDate").val(),e.endTimeStr=$("#endDate").val(),versionInit(e)})}})}function vChange(){var e=$("#startDate").val(),t=$("#endDate").val();versionsMsg.startTimeStr=e,versionsMsg.endTimeStr=t,versionInit(versionsMsg)}template.helper("filSize",function(e){return e<1024?(e||0)+"bytes":e<1048576?(e/1024).toFixed(2)+"KB":(e/1024/1024).toFixed(2)+"MB"}),template.helper("dateFormat",function(e,t){var a={M:(e=new Date(e)).getMonth()+1,d:e.getDate(),h:e.getHours(),m:e.getMinutes(),s:e.getSeconds(),q:Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};return t=t.replace(/([yMdhmsqS])+/g,function(t,n){var r=a[n];return void 0!==r?(t.length>1&&(r=(r="0"+r).substr(r.length-2)),r):"y"===n?(e.getFullYear()+"").substr(4-t.length):t})});var datepickerLang="zh"==common_i18n_lang?"zh-cn":"en";$("#startDate").on("click",function(){WdatePicker({onpicked:vChange,lang:datepickerLang,readOnly:!0,isShowClear:!1,maxDate:"#F{$dp.$D('endDate')}"})}),$("#endDate").on("click",function(){WdatePicker({onpicked:vChange,lang:datepickerLang,readOnly:!0,isShowClear:!1,minDate:"#F{$dp.$D('startDate')}"})});var versionsMsg={pageNo:1,pageSize:10,likeVer:$(".searchInput").val(),startTimeStr:$("#startDate").val(),endTimeStr:$("#endDate").val()},curDate=new Date,curYear=curDate.getFullYear(),tempMonth=curDate.getMonth()+1,curMonth=tempMonth>9?tempMonth:"0"+tempMonth,tempDay=curDate.getDate(),curDay=tempDay>9?tempDay:"0"+tempDay;versionsMsg.startTimeStr=getRecent3month()+"-01",versionsMsg.endTimeStr=curYear+"-"+curMonth+"-"+curDay,$("#startDate").val(versionsMsg.startTimeStr),$("#endDate").val(versionsMsg.endTimeStr),versionInit(versionsMsg),$(".versionSearchBtn").click(function(){var e=$(".searchInput").val(),t=$("#startDate").val(),a=$("#endDate").val();versionsMsg.likeVer=e,versionsMsg.startTimeStr=t,versionsMsg.endTimeStr=a,versionInit(versionsMsg)}),$("#startDate").change(function(){var e=$(this).val();versionsMsg.startTimeStr=e,versionInit(versionsMsg)}),$("#endDate").change(function(){var e=$(this).val();versionsMsg.endTimeStr=e,versionInit(versionsMsg)}),$("body").on("click",".active",function(){$(this).addClass("active").siblings(".active").removeClass("active")}),$("body").on("click",".detailBtn",function(){var e=$(this).attr("field");location.href="./dumpDetail?id="+e});